<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Cgroups verwalten</title>
		<meta name='Generator' content='Zim 0.56'>
		<style type='text/css'>
			a          { text-decoration: none      }
			a:hover    { text-decoration: underline }
			a:active   { text-decoration: underline }
			strike     { color: grey                }
			u          { text-decoration: none;
			             background-color: yellow   }
			tt         { color: #2e3436;            }
			pre        { color: #2e3436;
			             margin-left: 20px          }
			h1         { text-align: center;
			             color: #4e9a06             }
			h2         { color: #4e9a06             }
			h3         { color: #4e9a06             }
			h4         { color: #4e9a06             }
			h5         { color: #4e9a06             }
			span.insen { color: grey                }
			.page { max-width: 1000px;}
			.menu{
				float:left; width: 300px;
			}
			
			.content { padding-left: 320px;}
			.notebook{font-variant: small-caps;
					color:#4e9a06;
					padding: 0px 20px;}
			hr{clear:both;}
		</style>
		
	</head>
	<body>
		<div class="page">
			<div class="heading">
				<h1><a href="./Home.html" class="notebook">Notes:</a>
			
				
									Cgroups verwalten</h1>
			</div>
			<hr>
			<div class="menu">
				<ul>
<li><a href="../../../Linux_Wissen.html" title="Linux Wissen">Linux Wissen</a></li>
<ul>
<li><a href="../../Accessabillity.html" title="Accessabillity">Accessabillity</a></li>
<li><a href="../../Benutzer_und_Gruppen.html" title="Benutzer und Gruppen">Benutzer und Gruppen</a></li>
<li><a href="../../Bibliotheken.html" title="Bibliotheken">Bibliotheken</a></li>
<li><a href="../../Booten.html" title="Booten">Booten</a></li>
<li><a href="../../Dateien_verwalten.html" title="Dateien verwalten">Dateien verwalten</a></li>
<li><a href="../../Datenrettung_und_Forensik.html" title="Datenrettung und Forensik">Datenrettung und Forensik</a></li>
<li><a href="../../Drucken.html" title="Drucken">Drucken</a></li>
<li><a href="../../Emacs_Editor.html" title="Emacs Editor">Emacs Editor</a></li>
<li><a href="../../FHS.html" title="FHS">FHS</a></li>
<li><a href="../../Filterprogramme.html" title="Filterprogramme">Filterprogramme</a></li>
<li><a href="../../git_Vesionskontrolle.html" title="git Vesionskontrolle">git Vesionskontrolle</a></li>
<li><a href="../../Hardware_und_Systeminformationen.html" title="Hardware und Systeminformationen">Hardware und Systeminformationen</a></li>
<li><a href="../../Hilfe_erhalten.html" title="Hilfe erhalten">Hilfe erhalten</a></li>
<li><a href="../../Lokalisierung.html" title="Lokalisierung">Lokalisierung</a></li>
<li><a href="../../Monitoring.html" title="Monitoring">Monitoring</a></li>
<li><a href="../../Networking.html" title="Networking">Networking</a></li>
<li><a href="../../Paketverwaltung.html" title="Paketverwaltung">Paketverwaltung</a></li>
<li><a href="../../Partitionen_und_Dateisysteme.html" title="Partitionen und Dateisysteme">Partitionen und Dateisysteme</a></li>
<li><a href="../../Prozessverwaltung.html" title="Prozessverwaltung">Prozessverwaltung</a></li>
<ul>
<li><a href="../Cgroups.html" title="Cgroups">Cgroups</a></li>
<ul>
<li><a href="./cgconfig_und_cgred.html" title="cgconfig und cgred">cgconfig und cgred</a></li>
<li><a href="./Cgroups_erstellen_und_l%C3%B6schen.html" title="Cgroups erstellen und löschen">Cgroups erstellen und löschen</a></li>
<li><a href="./Cgroups_Subsysteme.html" title="Cgroups Subsysteme">Cgroups Subsysteme</a></li>
<li><strong>Cgroups verwalten</strong></li>
<li><a href="./Hierarchien_verwalten.html" title="Hierarchien verwalten">Hierarchien verwalten</a></li>
<li><a href="./Regeln.html" title="Regeln">Regeln</a></li>
</ul>
<li><a href="../kill.html" title="kill">kill</a></li>
<li><a href="../Magic_Sys-Abf_Taste.html" title="Magic Sys-Abf Taste">Magic Sys-Abf Taste</a></li>
<li><a href="../Nice_Werte_kontrollieren.html" title="Nice Werte kontrollieren">Nice Werte kontrollieren</a></li>
<li><a href="../ps.html" title="ps">ps</a></li>
<li><a href="../strace.html" title="strace">strace</a></li>
<li><a href="../top.html" title="top">top</a></li>
<li><a href="../ulimit.html" title="ulimit">ulimit</a></li>
</ul>
<li><a href="../../root.html" title="root">root</a></li>
<li><a href="../../Shell.html" title="Shell">Shell</a></li>
<li><a href="../../Sicherheit.html" title="Sicherheit">Sicherheit</a></li>
<li><a href="../../SQL.html" title="SQL">SQL</a></li>
<li><a href="../../Systemprogrammierung.html" title="Systemprogrammierung">Systemprogrammierung</a></li>
<li><a href="../../Systemprotokollierung.html" title="Systemprotokollierung">Systemprotokollierung</a></li>
<li><a href="../../Systemzeit.html" title="Systemzeit">Systemzeit</a></li>
<li><a href="../../Vim_Editor.html" title="Vim Editor">Vim Editor</a></li>
<li><a href="../../Web_Fetch_Tools.html" title="Web Fetch Tools">Web Fetch Tools</a></li>
<li><a href="../../X11.html" title="X11">X11</a></li>
<li><a href="../../Zeitgesteuerte_Vorg%C3%A4nge.html" title="Zeitgesteuerte Vorgänge">Zeitgesteuerte Vorgänge</a></li>
<li><a href="../../zzz_Undokumentiert.html" title="zzz Undokumentiert">zzz Undokumentiert</a></li>
</ul>
</ul>

			</div>
			<div class="content">
			<!-- Wiki content -->
				<p>
Created Dienstag 17 Januar 2012<br>
</p>

<p>
<ul>
<li>In jeder Cgroup können für die entsprechenden Subsysteme gesetzt werden</li>
</ul>
</p>

<h4>Informationen zu Cgroups erhalten</h4>
<p>
<strong>vorhandene Cgroups anzeigen</strong><br>
<code>cat /proc/cgroups</code><br>
</p>

<p>
<strong>lscgroup </strong>→ auflisten aller vorhandenen Cgroups<br>
Linux Wissen:FHS:proc<br>
</p>

<p>
<strong>Kontrollgruppe anzeigen die zu einem Prozess gehört</strong><br>
<code>ps -O cgroups</code><br>
Prozessverwaltung:ps<br>
</p>

<p>
<strong>PID anzeigen, die einer CGroup zugeordnet ist:</strong><br>
<code>cat /proc/PID/cgroup</code><br>
</p>

<p>
<strong>cgget &lt;Cgroup&gt;...</strong>→ Parameter für bestimmte Kontrollgruppen anzeigen lassen<br>
<div style='padding-left: 120pt'>
→ wird / als Parameter übergeben so werden Informationen über die Root Cgroup angezegt<br>
</div>
<strong>-r &lt;Parameter&gt; </strong>→ den Wert für den definierten Parameter anzeigen lassen, wobei Parameter auf eine Pseudeodatei verweist die Werte für ein Subsystem definiert <br>
<strong>-g &lt;Subsystem&gt; </strong>→ den Wert den ein zugewiesenes Subsystem hat<br>
</p>

<h4>Parameter für Subsysteme in Kontrollgruppen einstellen</h4>
<p>
<ul>
<li>entweder mit dem <strong>cgset </strong>Befehl oder durch beschreiben der Pseudodatei in die Kontrllgruppe der eingehängten Hierarchie:</li>
</ul>
<strong>echo &lt;Wert&gt; &gt; &lt;Hierarchie&gt;/&lt;Cgroup&gt;/&lt;Subsystem&gt;.&lt;Parameter&gt;</strong><br>
</p>

<p>
<em>Beispiel:</em><br>
<code>echo 0-1 &gt; /cgroups/cpuset/groupA/cpuset.cpus</code><br>
</p>

<p>
<strong>cgset &lt;Subsystem&gt;.&lt;Parameter&gt;=&lt;wert&gt; &lt;Cgroup Pfad relativ zur Hierarchie&gt; | /</strong><br>
→ Setzen von Subsystemparametern <br>
→ der Ausführende muss über die entsprechenden Berechtigungen für diese Cgroup verfügen<br>
<strong>→ </strong>wenn als Pfad / verwendet wird, wird der Parameter für die Rootgruppe dieser Hierarchie gesetzt<br>
<strong>-r </strong>→ rekursiv anwenden<br>
<strong>--copy-from &lt;Quelle Cgroup Pfad&gt;  &lt;Ziel Quellcodepfad&gt;</strong><br>
</p>

<h4>ACHTUNG:</h4>
<p>
<u>Für die Root-CGroup einer Hierarchie können nur spezifische Werte gesetzt werden. Alle Der Root Gruppe Unterliegenden Gruppen hängen von den Basis Subsystems Einstellungen der Root-Cgroup ab.</u><br>
</p>

<p>
<em>Beispiele:</em><br>
Für die Cgroup httpd_min innerhalb der <em>cpuacct</em> beinhaltenden Hierarchie deb Parameter <em>usage</em> festlegen<br>
<code>cgset -r cpuacct.usage=0 httpd_min</code><br>
</p>

<p>
Rekursiv für die Root-Gruppe einer Hierarchie den <em>cpuacct.usage </em>Parameter setzen<br>
<u>Da jedes Subsystem nur einmal verwendet werden kann, ist auch klar welche Hierarchie angesprochen wird</u><br>
<a href="./Regeln.html" title="Regeln">Regeln</a><br>
<code>cgset -r cpuacct.usage=0 /</code><br>
</p>

<p>
Gesetzte Parameter aus einer Cgroup in eine andere Cgroup kopieren<br>
<code>cgset --copy-from httpd_min/ httpd_user/</code><br>
<a href="./Cgroups_erstellen_und_l%C3%B6schen.html" title="Cgroups erstellen und löschen">Cgroups erstellen und löschen</a><br>
Linux Wissen:Dateien verwalten:Zugriffsrechte<br>
</p>

<h4>Ein bestehenden Prozess in eine CGroup verschieben</h4>
<p>
<ul>
<li>durch verschieben der PID in die <em>tasks </em>Datei</li>
</ul>
<strong>echo &lt;PID&gt; &gt; &lt;absoluter Cgroup Pfad&gt;/tasks</strong><br>
</p>

<p>
<em>Beispiel:</em><br>
<code>echo 1242 &gt; /cgroups/mem_cpu/httpd_min/tasks</code> <br>
</p>

<p>
<strong>cgclassify -g &lt;Subsystem&gt;,...|*:&lt;relativ zur Hierarchie glegener Pfad zur Cgroup&gt; &lt;PID&gt;,...</strong><br>
→ einen oder mehrere Prozesses mit den entsprechenden PIDs in eine Cgroup verschieben<br>
<strong>--sticky </strong>→ Option muss vor einer PID stehen<br>
                → alle Unterprozesses dieses Prozess werden der gleichen Cgroup zugeordnet<br>
</p>

<p>
<strong>--cancel-sticky </strong>→ Option muss vor einer PID stehen<br>
                             → alle Unterprozesse dieses Porzess sind nicht mehr länger dieser Cgroup zugehörig wie sein Vater<br>
</p>

<h4>ACHTUNG:</h4>
<p>
<u>Falls der </u><strong>cgred </strong><u>Daemon läuft, werden Zuweisungen von</u> <strong>cgclassify </strong><u>die Einstellungen in</u> /<em>etc/cgrules.conf </em><u>überschreiben.</u><br>
Prozessverwaltung<br>
<a href="./cgconfig_und_cgred.html" title="cgconfig und cgred">cgconfig und cgred</a><br>
Linux Wissen:FHS:etc:cgrules.conf<br>
</p>

<p>
<em>Beispiel: </em><br>
Die Befehle der PID 1242 und 2310 in die Cgroup httpd_min verschieben, dazu wird 2310 auf sticky gesetzt<br>
<code>cgclassify -g cpu,memory:httpd_min 1242 --sticky 2310</code><br>
</p>

<h4>Ein Prozess sofort in eine CGroup verschieben</h4>
<p>
<ul>
<li>durch verwenden der $$ Variale und des <strong>echo </strong>Befehls</li>
</ul>
<strong>echo $$ &gt; &lt;absoluter Cgroups Pfad&gt;/tasks &amp;&amp; &lt;Befehl&gt; &lt;Optionen&gt; &lt;Parameter&gt;</strong><br>
</p>

<p>
<em>Beispiel:</em><br>
dies würde den vim in die Gruppe mem_cpu Verlegen:<br>
<code>echo $$ /cgroups/system/mem_cpu/user1/tasks &amp;&amp; vim</code><br>
</p>

<p>
<strong>cgexec -g &lt;Subsystem&gt;,...|*:&lt;relativ zur Hierarchie gelegener Pfad zur Cgroup&gt; &lt;Befehl&gt; &lt;Optionen&gt; &lt;Parameter&gt;</strong><br>
→ einen Befehl ausführen und ihn alsTask dieser Cgroup zuordnen<br>
<strong>--sticky </strong>→ auch alle Unterprozesse die dieser Befehl spawned dieser Cgroup zuordnen<br>
</p>

<h4>Starten eines System Services in einer Cgroup</h4>
<p>
<ul>
<li>einem Service der durch <strong>systemd </strong>oder <strong>sys-V-init </strong>verwaltet wird, kann beim Starten einer Cgroup zugeordnet werden</li>
<li>dazu wird die Variable <code>ControlGroup</code> in einer der Konfigurationsdateien in <em>*/etc/sysconfig/&lt;Dienst&gt; gesetzt</em></li>
</ul>
<strong>ControlGroup="&lt;subsystem&gt;:&lt;CGroup&gt;"</strong><br>
<strong>CGROUP_DAEMON="&lt;subsystem&gt;:&lt;Cgroup&gt;" $$redhat</strong><br>
Linux Wissen:Booten:Dienste:systemd<br>
Linux Wissen:Booten:Dienste<br>
</p>

<h4>Löschen von Cgroups</h4>
<p>
<strong>cgdelelete &lt;subsystem&gt;,...|*:&lt;Cgroup&gt;</strong><br>
→ entfernen von Subsystemen und Cgroups<br>
<strong>-r </strong>rekursiv alle Untergruppen mit enfernen<br>
</p>

<p>
<em>Beispiel:</em><br>
Die Gruppe paul_hansen und deren Subsysteme cpu, und net_cls entfernen:<br>
<code>cgdelete cpu,net_cls:/paul_hansen</code><br>
</p>

<h4>Entladen aller Cgroups</h4>
<p>
<strong>cgclear </strong>→ entfernen aller Kontrollgruppen in allen Hierarchien<br>
              → zuweisen aller Prozesses zur Root Hierarchie Kontrollgruppe<br>
<div style='padding-left: 60pt'>
→ aushängen der Subsysteme und löschen der Verzeichnisse<br>
</div>
</p>
		

<h4>ACHTUNG:</h4>
<p>
<u>Alle Angelegten Cgroups gehen unwiederurflich verloren. Wenn keine Konfigurationsdatei existiert, liegt die vollständige Restaurierung der Cgroups Kontrollstruktur beim Administrator.Wurden die Hierarchien manuell gemounted, so muss der Eintrag </u>/<em>etc/mtab </em><u>entfernt werden.</u><br>
</p>


			<!-- End wiki content -->
			</div>
			<hr>
			<!-- Backlinks -->
			<div class="footer">
				Backlinks:
			<!-- End Backlinks -->
			</div>
		</div>
	</body>
</html>
