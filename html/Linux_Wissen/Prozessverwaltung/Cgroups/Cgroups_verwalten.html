<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Cgroups verwalten</title>
		<meta name='Generator' content='Zim 0.54'>
		<style type='text/css'>
			a          { text-decoration: none      }
			a:hover    { text-decoration: underline }
			a:active   { text-decoration: underline }
			strike     { color: grey                }
			u          { text-decoration: none;
			             background-color: yellow   }
			tt         { color: #2e3436;            }
			pre        { color: #2e3436;
			             margin-left: 20px          }
			h1         { text-align: center;
			             color: #4e9a06             }
			h2         { color: #4e9a06             }
			h3         { color: #4e9a06             }
			h4         { color: #4e9a06             }
			h5         { color: #4e9a06             }
			span.insen { color: grey                }
			.page { max-width: 1000px;}
			.menu{
				float:left; width: 300px;
			}
			
			.content { padding-left: 320px;}
			.notebook{font-variant: small-caps;
					color:#4e9a06;
					padding: 0px 20px;}
			hr{clear:both;}
		</style>
		
	</head>
	<body>
		<div class="page">
			<div class="heading">
				<h1><a href="./Home.html" class="notebook">Notes:</a>
			
				
									Cgroups verwalten</h1>
			</div>
			<hr>
			<div class="menu">
				<ul>
<li><a href="../../../Linux_Wissen.html" title="Linux Wissen">Linux Wissen</a></li>
<ul>
<li><a href="../../Accessabillity.html" title="Accessabillity">Accessabillity</a></li>
<li><a href="../../Benutzer_und_Gruppen.html" title="Benutzer und Gruppen">Benutzer und Gruppen</a></li>
<li><a href="../../Bibliotheken.html" title="Bibliotheken">Bibliotheken</a></li>
<li><a href="../../Booten.html" title="Booten">Booten</a></li>
<li><a href="../../Dateien_verwalten.html" title="Dateien verwalten">Dateien verwalten</a></li>
<li><a href="../../Datenrettung_und_Forensik.html" title="Datenrettung und Forensik">Datenrettung und Forensik</a></li>
<li><a href="../../Drucken.html" title="Drucken">Drucken</a></li>
<li><a href="../../Emacs_Editor.html" title="Emacs Editor">Emacs Editor</a></li>
<li><a href="../../FHS.html" title="FHS">FHS</a></li>
<li><a href="../../Filterprogramme.html" title="Filterprogramme">Filterprogramme</a></li>
<li><a href="../../git_Vesionskontrolle.html" title="git Vesionskontrolle">git Vesionskontrolle</a></li>
<li><a href="../../Hardware_und_Systeminformationen.html" title="Hardware und Systeminformationen">Hardware und Systeminformationen</a></li>
<li><a href="../../Hilfe_erhalten.html" title="Hilfe erhalten">Hilfe erhalten</a></li>
<li><a href="../../Lokalisierung.html" title="Lokalisierung">Lokalisierung</a></li>
<li><a href="../../Networking.html" title="Networking">Networking</a></li>
<li><a href="../../Paketverwaltung.html" title="Paketverwaltung">Paketverwaltung</a></li>
<li><a href="../../Partitionen_und_Dateisysteme.html" title="Partitionen und Dateisysteme">Partitionen und Dateisysteme</a></li>
<li><a href="../../Prozessverwaltung.html" title="Prozessverwaltung">Prozessverwaltung</a></li>
<ul>
<li><a href="../Cgroups.html" title="Cgroups">Cgroups</a></li>
<ul>
<li><a href="./cgconfig_und_cgred.html" title="cgconfig und cgred">cgconfig und cgred</a></li>
<li><a href="./Cgroups_erstellen_und_l%C3%B6schen.html" title="Cgroups erstellen und löschen">Cgroups erstellen und löschen</a></li>
<li><a href="./Cgroups_Subsysteme.html" title="Cgroups Subsysteme">Cgroups Subsysteme</a></li>
<li><strong>Cgroups verwalten</strong></li>
<li><a href="./Hierarchien_verwalten.html" title="Hierarchien verwalten">Hierarchien verwalten</a></li>
<li><a href="./Regeln.html" title="Regeln">Regeln</a></li>
</ul>
<li><a href="../kill.html" title="kill">kill</a></li>
<li><a href="../Magic_Sys-Abf_Taste.html" title="Magic Sys-Abf Taste">Magic Sys-Abf Taste</a></li>
<li><a href="../Nice_Werte_kontrollieren.html" title="Nice Werte kontrollieren">Nice Werte kontrollieren</a></li>
<li><a href="../ps.html" title="ps">ps</a></li>
<li><a href="../strace.html" title="strace">strace</a></li>
<li><a href="../top.html" title="top">top</a></li>
<li><a href="../ulimit.html" title="ulimit">ulimit</a></li>
</ul>
<li><a href="../../root.html" title="root">root</a></li>
<li><a href="../../Shell.html" title="Shell">Shell</a></li>
<li><a href="../../Sicherheit.html" title="Sicherheit">Sicherheit</a></li>
<li><a href="../../SQL.html" title="SQL">SQL</a></li>
<li><a href="../../Systemprogrammierung.html" title="Systemprogrammierung">Systemprogrammierung</a></li>
<li><a href="../../Systemprotokollierung.html" title="Systemprotokollierung">Systemprotokollierung</a></li>
<li><a href="../../Systemzeit.html" title="Systemzeit">Systemzeit</a></li>
<li><a href="../../Vim_Editor.html" title="Vim Editor">Vim Editor</a></li>
<li><a href="../../Web_Fetch_Tools.html" title="Web Fetch Tools">Web Fetch Tools</a></li>
<li><a href="../../X11.html" title="X11">X11</a></li>
<li><a href="../../Zeitgesteuerte_Vorg%C3%A4nge.html" title="Zeitgesteuerte Vorgänge">Zeitgesteuerte Vorgänge</a></li>
<li><a href="../../zzz_Undokumentiert.html" title="zzz Undokumentiert">zzz Undokumentiert</a></li>
</ul>
</ul>

			</div>
			<div class="content">
			<!-- Wiki content -->
				<li>In jeder Cgroup können für die entsprechenden Subsysteme gesetzt werden</li>

<strong>vorhandene Cgroups anzeigen</strong>
<code>cat /proc/cgroups</code>

<strong>lscgroup </strong>→ auflisten aller vorhandenen Cgroups<br>
<a href="../../FHS/proc.html" title="Linux Wissen:FHS:proc">Linux Wissen:FHS:proc</a>

<strong>Kontrollgruppe anzeigen die zu einem Prozess gehört</strong>
<code>ps -O cgroups</code>
<a href="../ps.html" title="Prozessverwaltung:ps">Prozessverwaltung:ps</a>

<strong>PID anzeigen, die einer CGroup zugeordnet ist:</strong>
<code>cat /proc/PID/cgroup</code>

<h4>Parameter für Subsysteme in Kontrollgruppen einstellen</h4>
<li>entweder mit dem <strong>cgset </strong>Befehl oder durch beschreiben der Pseudodatei in die Kontrllgruppe der eingehängten Hierarchie:</li>
<strong>echo &lt;Wert&gt; &gt; &lt;Hierarchie&gt;/&lt;Cgroup&gt;/&lt;Subsystem&gt;.&lt;Parameter&gt;</strong>

<em>Beispiel:</em>
<code>echo 0-1 &gt; /cgroups/cpuset/groupA/cpuset.cpus</code>

<strong>cgset &lt;Subsystem&gt;.&lt;Parameter&gt;=&lt;wert&gt; &lt;Cgroup Pfad relativ zur Hierarchie&gt; | /</strong><br>
→ Setzen von Subsystemparametern <br>
→ der Ausführende muss über die entsprechenden Berechtigungen für diese Cgroup verfügen<br>
<strong>→ </strong>wenn als Pfad / verwendet wird, wird der Parameter für die Rootgruppe dieser Hierarchie gesetzt<br>
<strong>-r </strong>→ rekursiv anwenden<br>
<strong>--copy-from &lt;Quelle Cgroup Pfad&gt;  &lt;Ziel Quellcodepfad&gt;</strong>

<h4>ACHTUNG:</h4>
<u>Für die Root-CGroup einer Hierarchie können nur spezifische Werte gesetzt werden. Alle Der Root Gruppe Unterliegenden Gruppen hängen von den Basis Subsystems Einstellungen der Root-Cgroup ab.</u>

<em>Beispiele:</em><br>
Für die Cgroup httpd_min innerhalb der <em>cpuacct</em> beinhaltenden Hierarchie deb Parameter <em>usage</em> festlegen<br>
<code>cgset -r cpuacct.usage=0 httpd_min</code><br>
<br>
Rekursiv für die Root-Gruppe einer Hierarchie den <em>cpuacct.usage </em>Parameter setzen<br>
<u>Da jedes Subsystem nur einmal verwendet werden kann, ist auch klar welche Hierarchie angesprochen wird</u>
<a href="./Regeln.html" title="Regeln">Regeln</a>
<code>cgset -r cpuacct.usage=0 /</code><br>
<br>
Gesetzte Parameter aus einer Cgroup in eine andere Cgroup kopieren<br>
<code>cgset --copy-from httpd_min/ httpd_user/</code>
<a href="./Cgroups_erstellen_und_l%C3%B6schen.html" title="Cgroups erstellen und löschen">Cgroups erstellen und löschen</a>
<a href="../../Dateien_verwalten/Zugriffsrechte.html" title="Linux Wissen:Dateien verwalten:Zugriffsrechte">Linux Wissen:Dateien verwalten:Zugriffsrechte</a>

<h4>Ein bestehenden Prozess in eine CGroup verschieben</h4>
<li>durch verschieben der PID in die <em>tasks </em>Datei</li>
<strong>echo &lt;PID&gt; &gt; &lt;absoluter Cgroup Pfad&gt;/tasks</strong>

<em>Beispiel:</em>
<code>echo 1242 &gt; /cgroups/mem_cpu/httpd_min/tasks</code> 

<strong>cgclassify -g &lt;Subsystem&gt;,...|*:&lt;relativ zur Hierarchie glegener Pfad zur Cgroup&gt; &lt;PID&gt;,...</strong><br>
→ einen oder mehrere Prozesses mit den entsprechenden PIDs in eine Cgroup verschieben<br>
<strong>--sticky </strong>→ Option muss vor einer PID stehen<br>
                → alle Unterprozesses dieses Prozess werden der gleichen Cgroup zugeordnet<br>
<br>
<strong>--cancel-sticky </strong>→ Option muss vor einer PID stehen<br>
                             → alle Unterprozesse dieses Porzess sind nicht mehr länger dieser Cgroup zugehörig wie sein Vater<br>
<br>
<h4>ACHTUNG:</h4>
<u>Falls der </u><strong>cgred </strong><u>Daemon läuft, werden Zuweisungen von</u> <strong>cgclassify </strong><u>die Einstellungen in</u> <em>*/etc/cgrules.conf </em><u>überschreiben.</u>
<a href="../../Prozessverwaltung.html" title="Prozessverwaltung">Prozessverwaltung</a>
<a href="./cgconfig_und_cgred.html" title="cgconfig und cgred">cgconfig und cgred</a>
<a href="../../FHS/etc/cgrules.conf.html" title="Linux Wissen:FHS:etc:cgrules.conf">Linux Wissen:FHS:etc:cgrules.conf</a>

<em>Beispiel: </em><br>
Die Befehle der PID 1242 und 2310 in die Cgroup httpd_min verschieben, dazu wird 2310 auf sticky gesetzt<br>
<code>cgclassify -g cpu,memory:httpd_min 1242 --sticky 2310</code>

<h4>Ein Prozess sofort in eine CGroup verschieben</h4>
<li>durch verwenden der $$ Variale und des <strong>echo </strong>Befehls</li>
<strong>echo $$ &gt; &lt;absoluter Cgroups Pfad&gt;/tasks &amp;&amp; &lt;Befehl&gt; &lt;Optionen&gt; &lt;Parameter&gt;</strong>

<em>Beispiel:</em><br>
dies würde den vim in die Gruppe mem_cpu Verlegen:<br>
<code>echo $$ /cgroups/system/mem_cpu/user1/tasks &amp;&amp; vim</code>

<strong>cgexec -g &lt;Subsystem&gt;,...|*:&lt;relativ zur Hierarchie gelegener Pfad zur Cgroup&gt; &lt;Befehl&gt; &lt;Optionen&gt; &lt;Parameter&gt;</strong><br>
→ einen Befehl ausführen und ihn alsTask dieser Cgroup zuordnen<br>
<strong>--sticky </strong>→ auch alle Unterprozesse die dieser Befehl spawned dieser Cgroup zuordnen<br>
<br>
<br>
<h4>Starten eines System Services in einer Cgroup</h4>
<li>einem Service der durch <strong>systemd </strong>oder <strong>sys-V-init </strong>verwaltet wird, kann beim Starten einer Cgroup zugeordnet werden</li>
<li>dazu wird die Variable <code>ControlGroup</code> in einer der Konfigurationsdateien in <em>*/etc/sysconfig/&lt;Dienst&gt; gesetzt</em></li>
<strong>ControlGroup="&lt;subsystem&gt;:&lt;CGroup&gt;"</strong>
<strong>CGROUP_DAEMON="&lt;subsystem&gt;:&lt;Cgroup&gt;" $$redhat</strong>

<a href="../../Booten/Dienste/systemd.html" title="Linux Wissen:Booten:Dienste:systemd">Linux Wissen:Booten:Dienste:systemd</a>
<a href="../../Booten/Dienste.html" title="Linux Wissen:Booten:Dienste">Linux Wissen:Booten:Dienste</a>


			<!-- End wiki content -->
			</div>
			<hr>
			<!-- Backlinks -->
			<div class="footer">
				Backlinks:
			<!-- End Backlinks -->
			</div>
		</div>
	</body>
</html>
